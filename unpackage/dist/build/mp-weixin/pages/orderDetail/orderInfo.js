"use strict";const e=require("../../common/vendor.js"),o=require("../../utils/api.js"),t=require("../../utils/auth.js");if(require("../../utils/request.js"),require("../../utils/env.js"),!Array){(e.resolveComponent("abEmpty")+e.resolveComponent("uni-card")+e.resolveComponent("uni-popup-dialog")+e.resolveComponent("uni-popup"))()}Math||(l+a+(()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup-dialog/uni-popup-dialog.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const a=()=>"./addRecords.js",l=()=>"../components/abButton.js",n={__name:"orderInfo",setup(a){let l=e.index.getStorageSync("orderId");const n=e.ref({}),u=["正常辣","微辣","特辣"];e.onLoad((async e=>{e.id&&(l=e.id);let t=await o.orderApi({id:l});n.value=t[0];let a=await o.addRecordsApi({orderId:l||"dfs2345"});s.value=a}));const i=e.ref(""),s=e.ref([]);e.onMounted((()=>{if(!t.getToken())try{document.getElementsByClassName("uni-page-head-btn")[0].style.display="none"}catch(e){}}));const r=e.ref(null),d=async()=>{if(i.value)return r.value.open();let e=await o.qrCodeApi({orderId:l});console.log(e),i.value=e,r.value.open()},p=()=>{console.log(i.value),e.index.saveImageToPhotosAlbum({filePath:i.value,success:o=>{e.index.showToast({title:"保存成功",icon:"success",mask:!0}),r.value.close()},fail:o=>{console.log(o),e.index.showModal({title:"失败",content:o.errMsg,showCancel:!0,success:({confirm:e,cancel:o})=>{}}),r.value.close()}})};return(o,a)=>{var l,c,v;return e.e({a:!n.value.isFinish&&n.value.takeMeal},!n.value.isFinish&&n.value.takeMeal?{b:e.t(n.value.takeMeal)}:{},{c:e.unref(t.getToken)()},e.unref(t.getToken)()?{d:e.o(d),e:e.p({icon:"link"})}:{},{f:e.t(n.value.orderName),g:e.t(n.value.isFinish?"已完成":"未完成"),h:e.n(n.value.isFinish?"text-text5":"text-text3"),i:e.t(u[n.value.taste-1]),j:n.value.desk},n.value.desk?{k:e.t(n.value.desk)}:{},{l:e.t(n.value.isPack?"打包":"未打包"),m:e.t(n.value.isAddMenu?"有":"无"),n:e.t(n.value.userOperation?"客户自助":"管理员"),o:e.t(null==(l=n.value.totalMoney)?void 0:l.toFixed(2)),p:n.value.isFinish},n.value.isFinish?{q:e.t((n.value.actualMoney||n.value.totalMoney).toFixed(2))}:{},{r:e.t(n.value.totalCount),s:e.t(n.value.id),t:e.t(n.value.showTime),v:null==(c=n.value.orderDetail)?void 0:c.length},(null==(v=n.value.orderDetail)?void 0:v.length)?{w:e.f(n.value.orderDetail,((o,t,a)=>({a:e.t(o.name),b:e.t(o.price.toFixed(2)),c:e.t(o.count),d:e.t((o.price*o.count).toFixed(2)),e:o.id})))}:{x:e.p({text:"暂无数据"})},{y:s.value.length>1},s.value.length>1?{z:e.p({recordsList:s.value})}:{},{A:i.value,B:e.o((e=>r.value.close())),C:e.o(p),D:e.p({title:"订单二维码",confirmText:"保存二维码",duration:2e3,"before-close":!0}),E:e.sr(r,"1311da32-4",{k:"popup2"}),F:e.p({type:"dialog"})})}}};wx.createPage(n);
