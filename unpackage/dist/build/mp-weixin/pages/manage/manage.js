"use strict";const e=require("../../common/vendor.js"),t=require("../../store/globalStore.js"),a=require("../../utils/api.js"),n=require("../../common/assets.js");if(require("../../utils/request.js"),require("../../utils/auth.js"),require("../../utils/env.js"),!Array){e.resolveComponent("uni-card")()}Math||(u+s+i+(()=>"../../uni_modules/uni-card/components/uni-card/uni-card.js"))();const i=()=>"../components/abMiniButton.js",s=()=>"../components/abButton.js",u=()=>"../components/abPicker.js",l={__name:"manage",setup(i){const s=e.ref(0),u=e.reactive([{text:"全部",value:0},...t.selectList.value]),l=e.ref([]);e.watchEffect((async()=>{(async()=>{let t={};s.value&&(t.type=s.value);let n=await a.menuApi(t);l.value=n,e.index.stopPullDownRefresh()})()}));e.onPullDownRefresh((async()=>{s.value=0;let t=await a.menuApi({type:s.value});l.value=t,e.index.stopPullDownRefresh()}));const o=()=>{e.index.navigateTo({url:"/pages/manage/addMenu"})};return(t,i)=>({a:e.o((e=>s.value=e)),b:e.p({selectList:u,label:"选择分类",modelValue:s.value}),c:e.o(o),d:e.p({icon:"plus"}),e:e.f(l.value,((t,i,s)=>({a:e.o((a=>(t=>{getApp().globalData.menuItem=t,e.index.navigateTo({url:"/pages/manage/addMenu",success:a=>{setTimeout((()=>{e.index.$emit("menuItem",t)}),200)}})})(t))),b:"0e27dfb5-3-"+s+",0e27dfb5-2-"+s,c:e.o((n=>(async t=>{e.index.showModal({title:"提示",content:`确定删除${t.name}吗？`,showCancel:!0,success:({confirm:n,cancel:i})=>{n&&a.deleteMenuApi({id:t.id}).then((a=>{e.index.showToast({title:"删除成功"}),l.value=l.value.filter((e=>e.id!=t.id))})).catch((t=>{e.index.showToast({title:"删除失败"+t})}))}})})(t))),d:"0e27dfb5-4-"+s+",0e27dfb5-2-"+s,e:e.o((a=>{return n=a,i=t.picImg,void("title"==n&&e.index.previewImage({urls:[i],success:e=>{},fail:e=>{}}));var n,i})),f:"0e27dfb5-2-"+s,g:e.p({title:t.name,thumbnail:t.picImg||e.unref(n.imgErr),"sub-title":u.find((e=>e.value==t.type)).text,extra:`价格：${t.price}`})}))),f:e.p({plain:!0}),g:e.p({plain:!0,type:"warn",icon:"trash",iconColor:"#fa2c19"})})}};wx.createPage(l);
